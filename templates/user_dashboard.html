{% extends "base.html" %}
{% block title %}My Requests{% endblock %}
{% block content %}

<div class="user-shell">

  <!-- User Sidebar -->
  <aside class="user-sidebar">
    <div class="user-brand">Ops Platform</div>

    <nav class="user-nav">
      <a class="active" href="#">Dashboard</a>
      <a href="#">My Requests</a>
      <a href="#">Notifications</a>
      <a href="#">Profile</a>
      <a href="#">Settings</a>

      <form method="POST" action="{{ url_for('auth.logout') }}">
        <button type="submit" class="btn user-logout">Logout</button>
      </form>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="user-content">

    <div class="card">
      <h2 style="margin-top:0;">My Requests</h2>
      <div class="muted">Signed in as {{ user["email"] }}</div>
    </div>

    <div class="card" style="margin-top:16px;">
      <span class="badge pending">Pending</span>
      <span class="badge approved" style="margin-left:8px;">Approved</span>
      <span class="badge denied" style="margin-left:8px;">Denied</span>
    </div>

    <h3 style="margin:24px 0 8px;">Recent Requests</h3>

    <table>
      <thead>
        <tr>
          <th>Request</th>
          <th>Category</th>
          <th>Status</th>
          <th>Submitted</th>
        </tr>
      </thead>
      <tbody>
        {% for r in my_requests %}
        <tr>
          <td>{{ r["request_type"] }}</td>
          <td>{{ r["category"] }}</td>
          <td><span class="badge {{ r['status'] }}">{{ r["status"] }}</span></td>
          <td class="muted">{{ r["created_at"] }}</td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="muted">No requests yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="card" style="margin-top:24px;">
      <h3 style="margin-top:0;">Submit a New Request</h3>

      <form method="POST" action="{{ url_for('requests.create_request') }}">
        <div class="field">
          <input class="input" name="request_type" placeholder="Request type (e.g. VPN Access)" required>
        </div>

        <div class="field">
          <select class="input" name="category" required>
            <option value="">Select category</option>
            <option value="Access">Access</option>
            <option value="Hardware">Hardware</option>
            <option value="Software">Software</option>
          </select>
        </div>

      <div class="field">
        <select class="input" name="priority" required>
          <option value="">Select priority</option>
          <option value="low">Low</option>
          <option value="medium">Medium</option>
          <option value="high">High</option>
      </select>
   </div>

        <button type="submit" class="btn">Submit Request</button>
      </form>
    </div>

  </main>
</div>

{% endblock %}
